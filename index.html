<!doctype html>
<html class="no-js" lang="">

<head>
  <style>
    table#dataGrid tr {
      cursor: pointer;
    }

    table#dataGrid tr.selected {
      background-color: #007bff;
      color: #ffffff;
    }

    .scrollable-table {
      max-height: 3 * 40px;
      /* 3 rows */
      overflow-y: scroll;
    }

    table#dataGrid tr:nth-child(n+4) {
      display: none;
    }

    form {
      background-color: lightgray;
      padding: 1rem;
      border: 1px solid grey;
    }

    .form-container,
    .table-container {
      margin-top: .8em;
      margin-left: 2.2em;
      width: 70%;
    }
  </style>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <meta name="theme-color" content="#fafafa">
</head>

<body>
  <!-- 
  Search area
 -->
  <div class="form-container">
    <form>
      <div class="form-group">
        <input type="text" class="form-control" id="searchBox" placeholder="Search..." />
      </div>
      <input type="button" class="btn btn-primary" id="searchBtn" value="Search" />
      <span id="error-message" style="color: red; display: none; margin-left: 8px; font-weight: 700;"></span>
    </form>
  </div>

  <!-- 
  The search results table
 -->
  <!-- <div class="table-container table-responsive"> -->
  <div class="table-container">
    <table class="table scrollable-table" id="dataGrid"
      style="border-left: 1px solid lightgrey; border-right: 1px solid lightgrey; border-bottom: 1px solid lightgrey; border-top: 1px solid lightgrey;">

      <thead>
        <tr>
          <th>Engineer Name</th>
          <th>Team</th>
          <th>Email</th>
          <th>HoursPerWeek</th>
          <th>Manager</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- 
  The Form that needs to save
 -->
    <form class="bg-light p-3 border">
      <div class="form-group row">
        <label for="engineerName" class="col-sm-3 col-form-label">EngineerName:</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" id="engineerName">
        </div>
      </div>
      <div class="form-group row">
        <label for="team" class="col-sm-3 col-form-label">Team:</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" id="team">
        </div>
      </div>
      <div class="form-group row">
        <label for="engineeringEmail" class="col-sm-3 col-form-label">Email:</label>
        <div class="col-sm-9">
          <input type="email" class="form-control" id="engineeringEmail">
        </div>
      </div>
      <div class="form-group row">
        <label for="engineerDefaultHoursPerWeek" class="col-sm-3 col-form-label">HoursPerWeek:</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" id="engineerDefaultHoursPerWeek">
        </div>
      </div>
      <div class="form-group row">
        <label for="manager" class="col-sm-3 col-form-label">Manager:</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" id="manager">
        </div>
      </div>
      <div class="form-group row">
        <div class="col-sm-9">
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
      </div>
    </form>
  </div>
  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    var data = [{
      engineerName: "Emily Davis",
      team: "Team A",
      engineeringEmail: "emily.davis@example.com",
      engineerDefaultHoursPerWeek: 40,
      manager: "John Smith"
    }, {
      engineerName: "Jacob Brown",
      team: "Team B",
      engineeringEmail: "jacob.brown@example.com",
      engineerDefaultHoursPerWeek: 35,
      manager: "Jane Doe"
    }, {
      engineerName: "Michael Garcia",
      team: "Team A",
      engineeringEmail: "michael.garcia@example.com",
      engineerDefaultHoursPerWeek: 38,
      manager: "John Smith"
    },
    // more data here
    {
      engineerName: "Jane Smith",
      team: "Team C",
      engineeringEmail: "jane.smith@example.com",
      engineerDefaultHoursPerWeek: 40,
      manager: "Mike Johnson"
    },
    {
      engineerName: "Mark Wilson",
      team: "Team A",
      engineeringEmail: "mark.wilson@example.com",
      engineerDefaultHoursPerWeek: 37,
      manager: "John Smith"
    },
    {
      engineerName: "Emily Taylor",
      team: "Team B",
      engineeringEmail: "emily.taylor@example.com",
      engineerDefaultHoursPerWeek: 35,
      manager: "Jane Doe"
    },
    {
      engineerName: "David Anderson",
      team: "Team C",
      engineeringEmail: "david.anderson@example.com",
      engineerDefaultHoursPerWeek: 40,
      manager: "Mike Johnson"
    },
    {
      engineerName: "Brian Lee",
      team: "Team A",
      engineeringEmail: "brian.lee@example.com",
      engineerDefaultHoursPerWeek: 38,
      manager: "John Smith"
    },
    {
      engineerName: "Sophia Perez",
      team: "Team B",
      engineeringEmail: "sophia.perez@example.com",
      engineerDefaultHoursPerWeek: 35,
      manager: "Jane Doe"
    },
    {
      engineerName: "Joshua Rivera",
      team: "Team C",
      engineeringEmail: "joshua.rivera@example.com",
      engineerDefaultHoursPerWeek: 40,
      manager: "Mike Johnson"
    }
    ];

    // +-----------------------------------+
    // | 
    // | Script area
    // | 
    // +-----------------------------------+

    $(document).ready(function () {
      // +-----------------------------------+
      // | 
      // | Setup responses for search button 
      // | and body of table clicks 
      // | 
      // +-----------------------------------+

      $("#searchBtn").click(searchHandler);
      $("#dataGrid tbody").on("click", "tr", rowClickHandler);

      // +-----------------------------------+
      // | Hide table if no results or
      // | search is empty
      // +-----------------------------------+

      function searchHandler() {
        removeAllErrors();
        var searchText = $("#searchBox").val();
        if (searchText === '') {
          $('#dataGrid').hide();
          $("#error-message").hide();
          clearGrid();
          return;
        }
        var searchResults = filterData(searchText);
        clearGrid();
        addRowsToGrid(searchResults.slice(0, 3));
        if ($('#dataGrid tbody tr').length <= 0) {
          $('#dataGrid').hide();
          $("#error-message").text("No matches found.").show();
        } else {
          $('#dataGrid').show();
          $("#error-message").hide();
        }
      }
      // +-----------------------------------+
      // | 
      // | See if data match
      // | 
      // +-----------------------------------+

      function filterData(searchText) {
        return $.grep(data, function (item) {
          var lowercaseEngineerName = item.engineerName.toLowerCase();
          var lowercaseSearchText = searchText.toLowerCase();
          var index = lowercaseEngineerName.indexOf(lowercaseSearchText);
          return index !== -1;
        });
      }
      // +-----------------------------------+
      // | 
      // | Clear the table
      // | 
      // +-----------------------------------+
      function clearGrid() {
        $("#dataGrid tbody").empty();
      }
      // +-----------------------------------+
      // | 
      // | Loop through data and add to table
      // | 
      // +-----------------------------------+

      function addRowsToGrid(searchResults) {
        for (var i = 0; i < searchResults.length; i++) {
          var row = "    <tr> " +
            "    <td> " + searchResults[i].engineerName + " </td>" +
            "    <td> " + searchResults[i].team + " </td>" +
            "    <td> " + searchResults[i].engineeringEmail + " </td>" +
            "    <td> " + searchResults[i].engineerDefaultHoursPerWeek + " </td>" +
            "    <td> " + searchResults[i].manager + " </td>" +
            "    </tr>";
          $("#dataGrid tbody").append(row);
        }
      }
      // +-----------------------------------+
      // | 
      // | If row in table selected, populate form
      // | 
      // +-----------------------------------+
      function rowClickHandler() {
        removeAllErrors();
        //Remove the selected class from all rows
        $("#dataGrid tbody tr").removeClass("selected");
        //Add the selected class to the current row
        $(this).addClass("selected");
        //Populate the form fields with the data from the selected row
        $("#engineerName").val($(this).find("td:eq(0)").text());
        $("#team").val($(this).find("td:eq(1)").text());
        $("#engineeringEmail").val($(this).find("td:eq(2)").text());
        $("#engineerDefaultHoursPerWeek").val($(this).find("td:eq(3)").text());
        $("#manager").val($(this).find("td:eq(4)").text());
      }
      // +-----------------------------------+
      // | 
      // | Start with data grid hidden
      // | 
      // +-----------------------------------+
      $('#dataGrid').hide();
      // +-----------------------------------+
      // | Respond to arrow keys to navigate |
      // | table                             |
      // +-----------------------------------+
      $(document).keyup(function (event) {
        var selectedRow = $("#dataGrid tbody tr.selected");
        removeAllErrors();
        if (event.keyCode === 38) { // up arrow key
          if (selectedRow.prev().length) {
            selectedRow.removeClass("selected");
            selectedRow = selectedRow.prev().addClass("selected");
            populateForm(selectedRow);
          }
        } else if (event.keyCode === 40) { // down arrow key
          if (selectedRow.next().length) {
            selectedRow.removeClass("selected");
            selectedRow = selectedRow.next().addClass("selected");
            populateForm(selectedRow);
          }
        } //else if (event.keyCode === 13) { // enter key
        //   populateForm(selectedRow);
        // }
      });

      // +-----------------------------------+
      // | 
      // | Fill form based on data selected 
      // | 
      // +-----------------------------------+

      function populateForm(selectedRow) {
        var engineerName = selectedRow.find("td:first").text();
        var team = selectedRow.find("td:nth-child(2)").text();
        var engineeringEmail = selectedRow.find("td:nth-child(3)").text();
        var engineerDefaultHoursPerWeek = selectedRow.find("td:nth-child(4)").text();
        var manager = selectedRow.find("td:last").text();
        $("#engineerName").val(engineerName);
        $("#team").val(team);
        $("#engineeringEmail").val(engineeringEmail);
        $("#engineerDefaultHoursPerWeek").val(engineerDefaultHoursPerWeek);
        $("#manager").val(manager);
      }
      // +-----------------------------------+
      // | 
      // | Sleep function
      // | 
      // +-----------------------------------+
      async function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
      $("#searchBox").on("input", function () {
        searchHandler();
      });

      // $(document).ready(function () {
      //   $('*').each(function () {
      //     console.log($(this).attr('id'));
      //   });
      // });
      $("form").submit(function (e) {
        e.preventDefault();
        var name = $("#engineerName").val();
        var email = $("#engineeringEmail").val();
        var hours = $("#engineerDefaultHoursPerWeek").val();
        var manager = $("#manager").val();
        var team = $("#team").val();
        var isValid = true;
        if (!validateName(name)) {
          removeError("#engineerName");
          $("#engineerName").after("<p class='text-danger'>Please enter valid engineer name</p>");
          isValid = false;
        }
        if (!validateEmail(email)) {
          removeError("#engineeringEmail");
          $("#engineeringEmail").after("<p class='text-danger'>Please enter a valid email address</p>");
          isValid = false;
        }
        if (!validateNumber(hours)) {
          removeError("#engineerDefaultHoursPerWeek");
          $("#engineerDefaultHoursPerWeek").after("<p class='text-danger'>Please enter a positive, non-zero number</p>");
          isValid = false;
        }
        if (!validateName(manager)) {
          removeError("#manager");
          $("#manager").after("<p class='text-danger'>Please enter the manager's name</p>");
          isValid = false;
        }
        if (!validateName(team)) {
          removeError("#team");
          $("#team").after("<p class='text-danger'>Please enter the team name</p>");
          isValid = false;
        }
        if (isValid) {
          // submit the form
        }
      });
      function validateName(name) {
        if (name.trim().length == 0 || !isNaN(name)) {
          return false;
        }
        return true;
      }

      function removeAllErrors() {
        removeError("#engineerName");
        removeError("#engineeringEmail");
        removeError("#engineerDefaultHoursPerWeek");
        removeError("#manager");
        removeError("#team");
      }



      function validateEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
      }

      function validateNumber(number) {
        if (number === '' || isNaN(number) || number < 0 || number > 40) {
          return false;
        }
        return true;
      }

      function removeError(fieldId) {
        if ($(fieldId).next(".text-danger").length) {
          $(fieldId).next(".text-danger").remove();
        }
      }
      $("#engineerName").on("input", function () {
        $(this).next(".text-danger").remove();
      });

      $("#engineeringEmail").on("input", function () {
        $(this).next(".text-danger").remove();
      });

      $("#engineerDefaultHoursPerWeek").on("input", function () {
        $(this).next(".text-danger").remove();
      });

      $("#manager").on("input", function () {
        $(this).next(".text-danger").remove();
      });

      $("#team").on("input", function () {
        $(this).next(".text-danger").remove();
      });
    });



  </script>
  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
  <script>
    window.ga = function () {
      ga.q.push(arguments)
    };
    ga.q = [];
    ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('set', 'transport', 'beacon');
    ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
</body>

</html>